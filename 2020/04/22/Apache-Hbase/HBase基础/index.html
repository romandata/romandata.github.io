<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Apache,Hbase," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="一、基础理论Hbase是一个非分布式的，面向列的开源数据库 基于BigTable 非结构化 存储在HDFS上，备份机制 线性扩展 cluster  &#x2F;  slave ：Hmaster、Regionserver Hbase架构图：  二、组件功能：Hbase数据模型：master负责维护表结构，regionserver负责存储数据：client通过 ZK 直连regionserver，即使maste">
<meta property="og:type" content="article">
<meta property="og:title" content="Hbase基础">
<meta property="og:url" content="https://romandata.github.io/2020/04/22/Apache-Hbase/HBase%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="Roman&#39;s Data">
<meta property="og:description" content="一、基础理论Hbase是一个非分布式的，面向列的开源数据库 基于BigTable 非结构化 存储在HDFS上，备份机制 线性扩展 cluster  &#x2F;  slave ：Hmaster、Regionserver Hbase架构图：  二、组件功能：Hbase数据模型：master负责维护表结构，regionserver负责存储数据：client通过 ZK 直连regionserver，即使maste">
<meta property="og:image" content="f:%5CmyGit%5CDT-Learner%5CApache-Hbase%5Cimage-1565608391940.png">
<meta property="article:published_time" content="2020-04-22T13:44:02.000Z">
<meta property="article:modified_time" content="2020-10-10T16:55:16.415Z">
<meta property="article:author" content="Roman">
<meta property="article:tag" content="Apache">
<meta property="article:tag" content="Hbase">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="f:%5CmyGit%5CDT-Learner%5CApache-Hbase%5Cimage-1565608391940.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    sidebar: {"position":"left","display":"post","offset":6,"offset_float":6,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://romandata.github.io/2020/04/22/Apache-Hbase/HBase基础/"/>





  <title>Hbase基础 | Roman's Data</title>
  














<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Roman's Data</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">铁马冰河入梦来</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://romandata.github.io/2020/04/22/Apache-Hbase/HBase%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Roman">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/blog.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Roman's Data">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Hbase基础</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-04-22T21:44:02+08:00">
                2020-04-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Apache-Hbase/" itemprop="url" rel="index">
                    <span itemprop="name">Apache-Hbase</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv">阅读量
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>次
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="一、基础理论"><a href="#一、基础理论" class="headerlink" title="一、基础理论"></a>一、基础理论</h3><p>Hbase是一个非分布式的，面向列的开源数据库</p>
<p>基于BigTable</p>
<p>非结构化</p>
<p>存储在HDFS上，备份机制</p>
<p>线性扩展</p>
<p>cluster  /  slave ：Hmaster、Regionserver</p>
<p>Hbase架构图：</p>
<p><img src="F:%5CmyGit%5CDT-Learner%5CApache-Hbase%5Cimage-1565608391940.png" alt="img"></p>
<h3 id="二、组件功能："><a href="#二、组件功能：" class="headerlink" title="二、组件功能："></a>二、组件功能：</h3><h6 id="Hbase数据模型："><a href="#Hbase数据模型：" class="headerlink" title="Hbase数据模型："></a>Hbase数据模型：</h6><p>master负责维护表结构，regionserver负责存储数据：client通过 ZK 直连regionserver，即使master挂掉也能查询数据，但是不能建表。</p>
<p>每个regionserver服务器上有多个region。</p>
<p>每张表都有一个或多个region，但是一张表中的不同region可能存在不同的regionserver上，这也是不建议一个表多个列族的原因之一。</p>
<p>每张表的每个列族都存在一个文件上，经历从 WAL -&gt; MemStore -&gt; Hfile 的过程。通常读操作的时候会遵循 Block Cache -&gt; MemStore -&gt; Hfile的顺序进行查找，以便效率的提升。</p>
<p>MemStore到一定大小会flush成Hfile，而Hfile数量提升时，会进行Compaction操作：</p>
<p>Minor Compaction：较小的Hfile合并成较大的Hfile，即小文件 –&gt; 大文件。减少Hfile数量，提升Hbase读性能。</p>
<p>Major Compaction：将对应一个column Family的所有Hfile合并成 一个 大的Hfile，并且会删除已经删除或者过期的Cell。很大的提升Hbase效率。但是Compaction中，包含大量的磁盘I/O和网络通信（有些Hfile已经在其他regionserver上，而此操作会将所有其他regionserver上的Hfile下载到本地），会造成region处于不可访问的状态。</p>
<p>NameSpace：每个命名空间都有可以有多张表，类比 Oracle中的database，MySQL中的schema。</p>
<p>Table：</p>
<p>Rowkey：</p>
<p>family_columns ： hbase 表中的每个列，都归属与某个列族。列族是表的 schema 的一部分(而列不是)，必须在 使用表之前定义。 列名都以列族作为前缀。例如 courses:history ， courses:math 都属于 courses 这个列族。 访问控制、磁盘和内存的使用统计都是在列族层面进行的。列族越多，在取一行数据时所要参与 IO、搜寻的文件就越多，所以，如果没有必要，不要 设置太多的列族 </p>
<p><strong>（每个列族存放在不同的文件中，建表时列族越少越好）</strong></p>
<p>TimeStamp</p>
<p>cell   没有数据类型，都是字节码的形式，  cell有多版本，Rowkey和列唯一确定cell，cell的版本通过时间戳来索引</p>
<p>  为了避免数据存在过多版本造成的的管理 (包括存贮和索引)负担， hbase 提供了两种数据版 本回收方式： </p>
<p>​                  保存数据的最后 n 个版本</p>
<p>​                  保存最近一段时间内的版本（设置数据的生命周期 TTL）。</p>
<p>用户可以针对每个列族进行设置。</p>
<h3 id="三、-HBase-shell-基本操作"><a href="#三、-HBase-shell-基本操作" class="headerlink" title="三、 HBase shell 基本操作"></a>三、 HBase shell 基本操作</h3><p>HBase shell 正常进入 shell 的界面：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@tnode1 ~]# hbase shell</span><br><span class="line">SLF4J: Class path contains multiple SLF4J bindings.</span><br><span class="line">SLF4J: Found binding in [jar:file:/usr/hdp/2.4.2.0-258/hadoop/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span><br><span class="line">SLF4J: Found binding in [jar:file:/usr/hdp/2.4.2.0-258/zookeeper/lib/slf4j-log4j12-1.6.1.jar!/org/slf4j/impl/StaticLoggerBinder.class]</span><br><span class="line">SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.</span><br><span class="line">SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]</span><br><span class="line">HBase Shell; enter 'help&lt;RETURN&gt;' for list of supported commands.</span><br><span class="line">Type "exit&lt;RETURN&gt;" to leave the HBase Shell</span><br><span class="line">Version 1.1.2.2.4.2.0-258, rUnknown, Mon Apr 25 06:36:21 UTC 2016</span><br><span class="line"></span><br><span class="line">hbase(main):001:0&gt;</span><br></pre></td></tr></table></figure>



<h4 id="命名空间相关"><a href="#命名空间相关" class="headerlink" title="命名空间相关"></a>命名空间相关</h4><p>类似与 MySQL 的 schema</p>
<h6 id="创建命名空间"><a href="#创建命名空间" class="headerlink" title="创建命名空间"></a>创建命名空间</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):004:0&gt; create_namespace &#39;testNS&#39;</span><br><span class="line">0 row(s) in 0.0980 seconds</span><br></pre></td></tr></table></figure>

<h6 id="删除命名空间"><a href="#删除命名空间" class="headerlink" title="删除命名空间"></a>删除命名空间</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):012:0&gt; drop_namespace &#39;testNS&#39;</span><br><span class="line">0 row(s) in 0.0270 seconds</span><br></pre></td></tr></table></figure>

<p>删除之前要先确定命名空间为空，否则会报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ERROR: org.apache.hadoop.hbase.constraint.ConstraintException: Only empty namespaces can be removed. Namespace testNS has 1 tables</span><br><span class="line">	at org.apache.hadoop.hbase.master.TableNamespaceManager.remove(TableNamespaceManager.java:198)</span><br><span class="line">	at org.apache.hadoop.hbase.master.HMaster.deleteNamespace(HMaster.java:2507)</span><br><span class="line">	at org.apache.hadoop.hbase.master.MasterRpcServices.deleteNamespace(MasterRpcServices.java:481)</span><br><span class="line">	at org.apache.hadoop.hbase.protobuf.generated.MasterProtos$MasterService$2.callBlockingMethod(MasterProtos.java:55453)</span><br><span class="line">	at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2114)</span><br><span class="line">	at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:101)</span><br><span class="line">	at org.apache.hadoop.hbase.ipc.RpcExecutor.consumerLoop(RpcExecutor.java:130)</span><br><span class="line">	at org.apache.hadoop.hbase.ipc.RpcExecutor$1.run(RpcExecutor.java:107)</span><br><span class="line">	at java.lang.Thread.run(Thread.java:748)</span><br><span class="line"></span><br><span class="line">Here is some help for this command:</span><br><span class="line">Drop the named namespace. The namespace must be empty.</span><br></pre></td></tr></table></figure>



<h4 id="表相关"><a href="#表相关" class="headerlink" title="表相关"></a>表相关</h4><h6 id="创建表"><a href="#创建表" class="headerlink" title="创建表"></a>创建表</h6><p>简单创建和设置列簇属性的创建</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):005:0&gt; create &#39;userInfo&#39;,&#39;baseInfo&#39;</span><br><span class="line">0 row(s) in 1.4830 seconds</span><br><span class="line"></span><br><span class="line">&#x3D;&gt; Hbase::Table - userInfo</span><br><span class="line"></span><br><span class="line">hbase(main):030:0&gt; create &#39;test:userInfo&#39;, &#123; NAME&#x3D;&gt;&#39;baseInfo&#39;,VERSIONS&#x3D;&gt;6 &#125;, &#123; NAME&#x3D;&gt;&#39;extrInfo&#39;,CONFIGURATION&#x3D;&gt; &#123;&#39;hbase.hstore.blockingStoreFiles&#39;&#x3D;&gt;&#39;15&#39;&#125; &#125;</span><br><span class="line">0 row(s) in 1.2300 seconds</span><br><span class="line"></span><br><span class="line">&#x3D;&gt; Hbase::Table - test:userInfo</span><br></pre></td></tr></table></figure>

<h6 id="列出表"><a href="#列出表" class="headerlink" title="列出表"></a>列出表</h6><p>两种，一种是列出所有表，一种是列出符合正则表达式的表 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):021:0&gt; list</span><br><span class="line">TABLE</span><br><span class="line">test:customerTable</span><br><span class="line">1 row(s) in 0.0040 seconds</span><br><span class="line"></span><br><span class="line">&#x3D;&gt; [&quot;test:customerTable&quot;]</span><br><span class="line"></span><br><span class="line">hbase(main):025:0&gt; list &#39;.*Table&#39;</span><br><span class="line">TABLE</span><br><span class="line">test:customerTable</span><br><span class="line">1 row(s) in 0.0030 seconds</span><br><span class="line"></span><br><span class="line">&#x3D;&gt; [&quot;test:customerTable&quot;]</span><br></pre></td></tr></table></figure>

<h6 id="查看表"><a href="#查看表" class="headerlink" title="查看表"></a>查看表</h6><p>desc 和 describe 一样</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):024:0&gt; desc &#39;test:customerTable&#39;</span><br><span class="line">Table test:customerTable is ENABLED                                                   test:customerTable                                                                   COLUMN FAMILIES DESCRIPTION                                                           &#123;NAME &#x3D;&gt; &#39;info&#39;, BLOOMFILTER &#x3D;&gt; &#39;ROW&#39;, VERSIONS &#x3D;&gt; &#39;3&#39;, IN_MEMORY &#x3D;&gt; &#39;false&#39;, KEEP_DELETED_CELLS &#x3D;&gt; &#39;FALSE&#39;, DATA_BLOCK_ENCODING &#x3D;&gt; &#39;NONE&#39;, TTL &#x3D;&gt; &#39;FOREVER&#39;, COMPRESSION &#x3D;&gt; &#39;NONE&#39;, MIN_VERSIONS &#x3D;&gt; &#39;0&#39;, BLOCKCACHE &#x3D;&gt; &#39;true&#39;, BLOCKSIZE &#x3D;&gt; &#39;65536&#39;, REPLICATION_SCOPE &#x3D;&gt; &#39;0&#39;</span><br><span class="line">&#125;                                                                                     &#123;NAME &#x3D;&gt; &#39;other&#39;, BLOOMFILTER &#x3D;&gt; &#39;ROW&#39;, VERSIONS &#x3D;&gt; &#39;3&#39;, IN_MEMORY &#x3D;&gt; &#39;false&#39;, KEEP_DELETED_CELLS &#x3D;&gt; &#39;FALSE&#39;, DATA_BLOCK_ENCODING &#x3D;&gt; &#39;NONE&#39;, TTL &#x3D;&gt; &#39;FOREVER&#39;, COMPRESSION &#x3D;&gt; &#39;NONE&#39;, MIN_VERSIONS &#x3D;&gt; &#39;0&#39;, BLOCKCACHE &#x3D;&gt; &#39;true&#39;, BLOCKSIZE &#x3D;&gt; &#39;65536&#39;, REPLICATION_SCOPE &#x3D;&gt; &#39;0</span><br><span class="line">&#39;&#125;                                                                                     2 row(s) in 0.0180 seconds</span><br></pre></td></tr></table></figure>

<h6 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h6><p>删除单张和正则表达式批量删除两种</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># 删除单张</span><br><span class="line">hbase(main):009:0&gt; drop &#39;testNS:userInfo&#39;</span><br><span class="line"></span><br><span class="line">ERROR: Table testNS:userInfo is enabled. Disable it first.</span><br><span class="line"></span><br><span class="line">Here is some help for this command:</span><br><span class="line">Drop the named table. Table must first be disabled:</span><br><span class="line">  hbase&gt; drop &#39;t1&#39;</span><br><span class="line">  hbase&gt; drop &#39;ns1:t1&#39;</span><br><span class="line"></span><br><span class="line">hbase(main):010:0&gt; disable &#39;testNS:userInfo&#39;</span><br><span class="line">0 row(s) in 2.2520 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):011:0&gt; drop &#39;testNS:userInfo&#39;</span><br><span class="line">0 row(s) in 1.2390 seconds</span><br><span class="line"></span><br><span class="line"># 删除一批</span><br><span class="line">hbase(main):020:0&gt; drop_all &#39;.*Info&#39;</span><br><span class="line">custInfo</span><br><span class="line">userInfo                                                                             </span><br><span class="line"></span><br><span class="line">Drop the above 2 tables (y&#x2F;n)?</span><br><span class="line">y</span><br><span class="line">2 tables successfully dropped</span><br></pre></td></tr></table></figure>

<p>删表之前需要先禁用表</p>
<h6 id="启停表"><a href="#启停表" class="headerlink" title="启停表"></a>启停表</h6><p>单表启停，批量启停，检查启停状态等六类</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):032:0&gt; disable 'test:userInfo'</span><br><span class="line">0 row(s) in 2.2620 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):033:0&gt; enable 'test:userInfo'</span><br><span class="line">0 row(s) in 1.2350 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):034:0&gt; disable_all 'test:.*s.*'</span><br><span class="line">test:customerTable</span><br><span class="line">test:userInfo</span><br><span class="line"></span><br><span class="line">Disable the above 2 tables (y/n)?</span><br><span class="line">y</span><br><span class="line">2 tables successfully disabled</span><br><span class="line"></span><br><span class="line">hbase(main):035:0&gt; is_disabled 'test:userInfo'</span><br><span class="line">true                                                                                           </span><br><span class="line">0 row(s) in 0.0050 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):036:0&gt; is_enabled 'test:userInfo'</span><br><span class="line">false</span><br><span class="line">0 row(s) in 0.0050 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):037:0&gt; enable_all 'test:.*s.*'</span><br><span class="line">test:customerTable</span><br><span class="line">test:userInfo               </span><br><span class="line"></span><br><span class="line">Enable the above 2 tables (y/n)?</span><br><span class="line">y</span><br><span class="line">2 tables successfully enabled</span><br><span class="line"></span><br><span class="line">hbase(main):038:0&gt; is_disabled 'test:userInfo'</span><br><span class="line">false</span><br><span class="line"></span><br><span class="line">0 row(s) in 0.0110 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):039:0&gt; is_enabled 'test:userInfo'</span><br><span class="line">true</span><br><span class="line"></span><br><span class="line">0 row(s) in 0.0090 seconds</span><br></pre></td></tr></table></figure>

<h6 id="修改表"><a href="#修改表" class="headerlink" title="修改表"></a>修改表</h6><p><code>hbase.online.schema.update.enable</code> 该参数如果是 false，那么修改时必须先 </p>
<p>表。 如果为 true，那么可以直接修改表</p>
<p><strong>新增修改列簇</strong>（HBase中修改和新增是一个操作）。如果传入新的列族名，可以新建列族；如果传入已存在的列族名，可以修改列族属性。列族属性有： </p>
<ul>
<li>BLOOMFILTER </li>
<li>REPLICATION_SCOPE </li>
<li>MIN_VERSIONS </li>
<li>COMPRESSION </li>
<li>TTL </li>
<li>BLOCKSIZE </li>
<li>IN_MEMORY </li>
<li>IN_MEMORY_COMPACTION </li>
<li>BLOCKCACHE </li>
<li>KEEP_DELETED_CELLS</li>
<li>DATA_BLOCK_ENCODING </li>
<li>CACHE_DATA_ON_WRITE </li>
<li>CACHE_DATA_IN_L1 </li>
<li>CACHE_INDEX_ON_WRITE </li>
<li>CACHE_BLOOMS_ON_WRITE </li>
<li>EVICT_BLOCKS_ON_CLOSE </li>
<li>PREFETCH_BLOCKS_ON_OPEN </li>
<li>ENCRYPTION </li>
<li>ENCRYPTION_KEY </li>
<li>IS_MOB_BYTES </li>
<li>MOB_THRESHOLD_BYTES</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"># 直接新增</span><br><span class="line">hbase(main):013:0&gt; alter &#39;test:userInfo&#39;,&#123;NAME&#x3D;&gt;&#39;cccfff&#39;&#125;</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">0 row(s) in 1.9110 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):015:0&gt; alter &#39;test:userInfo&#39;,NAME&#x3D;&gt;&#39;cccfff&#39;</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">0 row(s) in 1.9050 seconds</span><br><span class="line"></span><br><span class="line"># 新增两个列簇</span><br><span class="line">hbase(main):020:0&gt; alter &#39;test:userInfo&#39;,&#39;cccfff&#39;,&#123;NAME&#x3D;&gt;&#39;cf123&#39;,VERSIONS&#x3D;&gt;4&#125;</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">^[[A^[[A^[[ADone.</span><br><span class="line">0 row(s) in 3.7370 seconds</span><br><span class="line"></span><br><span class="line"># 删除列簇</span><br><span class="line">hbase(main):005:0&gt; alter &#39;test:userInfo&#39;,&#39;delete&#39;&#x3D;&gt;&#39;cccfff&#39;</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">0 row(s) in 1.9010 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):009:0&gt; alter &#39;test:userInfo&#39;,METHOD&#x3D;&gt;&#39;delete&#39;,NAME&#x3D;&gt;&#39;cf111&#39;</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">0 row(s) in 1.8940 seconds</span><br><span class="line"></span><br><span class="line"># 新增的同时删除一个</span><br><span class="line"># 指定 METHOD 的方式</span><br><span class="line">hbase(main):022:0&gt; alter &#39;test:userInfo&#39;,&#39;cccfff&#39;,&#123;NAME&#x3D;&gt;&#39;cf123&#39;,METHOD&#x3D;&gt;&#39;delete&#39;&#125;</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">0 row(s) in 3.7420 seconds</span><br><span class="line"># 直接使用 delete 方法指定需要删除的列簇</span><br><span class="line">hbase(main):025:0&gt; alter &#39;test:userInfo&#39;,&#39;cccfff&#39;,&#39;delete&#39;&#x3D;&gt;&#39;cf123&#39;</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">0 row(s) in 3.7350 second</span><br></pre></td></tr></table></figure>

<p><strong>修改表级别属性</strong>。表级别的属性有：</p>
<ul>
<li>MAX_FILESIZE </li>
<li>READONLY </li>
<li>MEMSTORE_FLUSHSIZE </li>
<li>DEFERRED_LOG_FLUSH </li>
<li>DURABILITY </li>
<li>REGION_REPLICATION </li>
<li>NORMALIZATION_ENABLED </li>
<li>PRIORITY </li>
<li>IS_ROOT </li>
<li>IS_META</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):027:0&gt; alter &#39;test:userInfo&#39;,MAX_FILESIZE &#x3D;&gt; &#39;123217728&#39;</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">0 row(s) in 1.9200 seconds</span><br></pre></td></tr></table></figure>

<p><strong>删除表级别属性。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):001:0&gt; alter &#39;test:userInfo&#39;,METHOD &#x3D;&gt; &#39;table_att_unset&#39;, NAME &#x3D;&gt; &#39;MAX_FILESIZE&#39;</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">0 row(s) in 2.1860 seconds</span><br></pre></td></tr></table></figure>

<p><strong>设置表配置。</strong> 即修改表/列簇在 hbase-site.xml 中的配置，而不影响其他表。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):011:0&gt; alter &#39;test:userInfo&#39;,CONFIGURATION &#x3D;&gt; &#123;&#39;hbase.hstore.blockingStoreFiles&#39; &#x3D;&gt; &#39;10&#39; &#125;</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">0 row(s) in 1.8880 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):014:0&gt; alter &#39;test:userInfo&#39;,&#123; NAME &#x3D;&gt; &#39;extrInfo&#39;, CONFIGURATION &#x3D;&gt; &#123;&#39;hbase.hstore.blockingStoreFiles&#39; &#x3D;&gt; &#39;10&#39; &#125;&#125;</span><br><span class="line">Updating all regions with the new schema...</span><br><span class="line">1&#x2F;1 regions updated.</span><br><span class="line">Done.</span><br><span class="line">0 row(s) in 1.8850 seconds</span><br></pre></td></tr></table></figure>



<h4 id="查询相关"><a href="#查询相关" class="headerlink" title="查询相关"></a>查询相关</h4><h6 id="scan"><a href="#scan" class="headerlink" title="scan"></a>scan</h6><p>遍历所有数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; scan &#39;test:userInfo&#39;</span><br></pre></td></tr></table></figure>

<p>指定列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; scan &#39;test:userInfo&#39;,&#123;COLUMNS&#x3D;&gt;&#39;cf1:name&#39;&#125;</span><br></pre></td></tr></table></figure>

<p>限制返回行数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; scan &#39;test:userInfo&#39;,&#123; LIMIT&#x3D;&gt;10 &#125;</span><br><span class="line">&gt; scan &#39;test:userInfo&#39;,&#123; COLUMNS&#x3D;&gt;&#39;cf1:name&#39;, LIMIT&#x3D;&gt;10&#125;</span><br></pre></td></tr></table></figure>

<p>指定 rowkey 范围。包含 STARTROW，不包含 ENDROW数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; scan &#39;test:userInfo&#39;,&#123;STARTROW &#x3D;&gt; &#39;0001&#39;, ENDROW &#x3D;&gt; &#39;00002&#39;&#125;</span><br></pre></td></tr></table></figure>

<p>指定时间戳范围。左闭右开范围。会查询到历史版本信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; scan &#39;test:userInfo&#39;,&#123;TIMERANGE&#x3D;&gt;[1569306706585, 1569316490296]&#125;</span><br></pre></td></tr></table></figure>

<p>查询多版本数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; scan &#39;test:userInfo&#39;,&#123;VERSIONS&#x3D;&gt;3&#125;</span><br></pre></td></tr></table></figure>

<p>显示原始记录。即查询所有数据，包含已经标记为删除的数据。必须配合 VERSIONS 使用，不能和 COLUMNS 一起使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; scan &#39;test:userInfo&#39;,&#123;VERSIONS&#x3D;&gt;3,RAW&#x3D;&gt;true&#125;</span><br></pre></td></tr></table></figure>

<p>指定过滤器。 如果多个，使用 AND 和 OR 来进行连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; scan &#39;test:userInfo&#39;, &#123;FILTER &#x3D;&gt; &quot;FamilyFilter(&#x3D;,&#39;substring:f&#39;)&quot;&#125;</span><br><span class="line">&gt; scan &#39;test:userInfo&#39;, &#123;FILTER &#x3D;&gt; &quot;FamilyFilter(!&#x3D;,&#39;substring:info&#39;) AND ValueFilter(&gt;&#x3D;,&#39;binary:X&#39;)&quot;&#125;</span><br></pre></td></tr></table></figure>



<h6 id="get"><a href="#get" class="headerlink" title="get"></a>get</h6><p>获取对应 rowkey 所有数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; get &#39;test:userInfo&#39;,&#39;00002&#39;</span><br></pre></td></tr></table></figure>

<p>获取对应 rowkey 部分列数据，多个列可以用 [] 组合起来。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; get &#39;test:userInfo&#39;,&#39;00002&#39;, &#123;COLUMN&#x3D;&gt; &#39;cf1&#39;&#125;</span><br><span class="line">&gt; get &#39;test:userInfo&#39;,&#39;00002&#39;, &#123;COLUMN&#x3D;&gt; [&#39;extrInfo&#39;,&#39;baseInfo&#39;,&#39;cf1&#39;] &#125;</span><br></pre></td></tr></table></figure>

<p>获取对应 rowkey 时间戳范围的数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; get &#39;test:userInfo&#39;,&#39;00002&#39;, &#123;TIMERANGE&#x3D;&gt;[1569317161496,1569317463581]&#125;</span><br></pre></td></tr></table></figure>

<p>获取对应 rowkey 数据，指定版本数。不能单独使用 VERSIONS，必须配合 column 或者 timerange一起用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):075:0&gt; get &#39;test:userInfo&#39;,&#39;00002&#39;, &#123; VERSIONS &#x3D;&gt; 3&#125;</span><br><span class="line">COLUMN                                CELL</span><br><span class="line"></span><br><span class="line">ERROR: Failed parse of &#123;&quot;VERSIONS&quot;&#x3D;&gt;3&#125;, Hash</span><br><span class="line"></span><br><span class="line">&gt; get &#39;test:userInfo&#39;,&#39;00002&#39;, &#123;TIMERANGE&#x3D;&gt;[1569317161495,1569317463582],VERSIONS&#x3D;&gt;3&#125;</span><br><span class="line">&gt; get &#39;test:userInfo&#39;,&#39;00002&#39;, &#123;COLUMN&#x3D;&gt;&#39;cf1&#39;, VERSIONS &#x3D;&gt; 3&#125;</span><br></pre></td></tr></table></figure>

<p>获取对应 rowkey 的数据，使用过滤器过滤。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; get &#39;test:userInfo&#39;,&#39;00002&#39;, &#123;FILTER&#x3D;&gt;&quot;ValueFilter(&#x3D;,&#39;substring:XG&#39;)&quot;&#125;</span><br><span class="line"></span><br><span class="line">&gt; get &#39;test:userInfo&#39;,&#39;00002&#39;, &#123;TIMERANGE&#x3D;&gt;[1569317161495,1569317463582],VERSIONS&#x3D;&gt;3,FILTER&#x3D;&gt;&quot;ValueFilter(&#x3D;,&#39;substring:X&#39;)&quot;&#125;</span><br></pre></td></tr></table></figure>



<h6 id="count"><a href="#count" class="headerlink" title="count"></a>count</h6><p>计算表行数，用法三种：</p>
<p>1、直接出结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; count &#39;test:userInfo&#39;</span><br></pre></td></tr></table></figure>

<p>2、指定步长，每步打印当前结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; count &#39;test:userInfo&#39;, INTERVAL&#x3D;1</span><br></pre></td></tr></table></figure>

<p>3、指定缓存</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; count &#39;test:userInfo&#39;, INTERVAL&#x3D;1, CACHE&#x3D;2</span><br></pre></td></tr></table></figure>



<h4 id="删除相关"><a href="#删除相关" class="headerlink" title="删除相关"></a>删除相关</h4><h6 id="delete"><a href="#delete" class="headerlink" title="delete"></a>delete</h6><p>删除指定行中某列的数据，或者某列的某个版本的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">delete &#39;test:userInfo&#39;,&#39;00002&#39;,&#39;cf1:name&#39;</span><br><span class="line">delete &#39;test:userInfo&#39;,&#39;00002&#39;,&#39;cf1:name&#39;, 1569399092124</span><br></pre></td></tr></table></figure>



<h6 id="deleteall"><a href="#deleteall" class="headerlink" title="deleteall"></a>deleteall</h6><p>delete加强版，除原有功能，还可以删除整行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deleteall &#39;test:userInfo&#39;,&#39;00006&#39;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):004:0&gt; scan &#39;test:userInfo&#39;,&#123;VERSIONS&#x3D;&gt;5,RAW&#x3D;&gt;true&#125;</span><br><span class="line">ROW                                                                  COLUMN+CELL</span><br><span class="line"> 00001                                                               column&#x3D;cf1:name, timestamp&#x3D;1569306706585, value&#x3D;Wade111</span><br><span class="line"> 00002                                                               column&#x3D;cf1:name, timestamp&#x3D;1569400533054, type&#x3D;DeleteColumn</span><br><span class="line"> 00002                                                               column&#x3D;cf1:name, timestamp&#x3D;1569399423111, value&#x3D;lxmkkk</span><br><span class="line"> 00003                                                               column&#x3D;cf1:name, timestamp&#x3D;1569396888055, value&#x3D;lalalla</span><br><span class="line"> 00004                                                               column&#x3D;cf1:name, timestamp&#x3D;1569396894851, value&#x3D;lalalla2222</span><br><span class="line"> 00005                                                               column&#x3D;cf1:name, timestamp&#x3D;1569396907028, value&#x3D;lalalla222333333</span><br><span class="line"> 00006                                                               column&#x3D;MAX_FILESIZE:, timestamp&#x3D;1569400663358, type&#x3D;DeleteFamily</span><br><span class="line"> 00006                                                               column&#x3D;baseInfo:, timestamp&#x3D;1569400663358, type&#x3D;DeleteFamily</span><br><span class="line"> 00006                                                               column&#x3D;cf1:, timestamp&#x3D;1569400663358, type&#x3D;DeleteFamily</span><br><span class="line"> 00006                                                               column&#x3D;cf1:name, timestamp&#x3D;1569396916208, value&#x3D;lalalla2223333335555555</span><br><span class="line"> 00006                                                               column&#x3D;extrInfo:, timestamp&#x3D;1569400663358, type&#x3D;DeleteFamily</span><br><span class="line"> 00006                                                               column&#x3D;table_att_unset:, timestamp&#x3D;1569400663358, type&#x3D;DeleteFamily</span><br><span class="line">6 row(s) in 0.0180 seconds</span><br></pre></td></tr></table></figure>



<h4 id="过滤器相关"><a href="#过滤器相关" class="headerlink" title="过滤器相关"></a>过滤器相关</h4><h6 id="过滤器基础"><a href="#过滤器基础" class="headerlink" title="过滤器基础"></a>过滤器基础</h6><p>过滤器的<strong>操作符</strong> </p>
<table>
<thead>
<tr>
<th align="center">API</th>
<th align="center">shell</th>
</tr>
</thead>
<tbody><tr>
<td align="center">LESS</td>
<td align="center">&lt;</td>
</tr>
<tr>
<td align="center">LESS_OR_EQUAL</td>
<td align="center">&lt;=</td>
</tr>
<tr>
<td align="center">EQUAL</td>
<td align="center">=</td>
</tr>
<tr>
<td align="center">NOT_EQUAL</td>
<td align="center">&lt;&gt;   or   !=</td>
</tr>
<tr>
<td align="center">GREATER_OR_EQUAL</td>
<td align="center">&gt;=</td>
</tr>
<tr>
<td align="center">GREATER</td>
<td align="center">&gt;</td>
</tr>
<tr>
<td align="center">NO_OP</td>
<td align="center"></td>
</tr>
</tbody></table>
<p>过滤器中的<strong>比较器</strong> </p>
<table>
<thead>
<tr>
<th align="center">API</th>
<th align="center">shell</th>
</tr>
</thead>
<tbody><tr>
<td align="center">BinaryComparator<br />按字节索引顺序比较指定字节数组</td>
<td align="center">binary</td>
</tr>
<tr>
<td align="center">BinaryPrefixComparator<br />和第一个一样的效果，只不过比较前几个</td>
<td align="center">binaryprefix</td>
</tr>
<tr>
<td align="center">NullComparator<br />判断是否为空</td>
<td align="center">null</td>
</tr>
<tr>
<td align="center">BitComparator<br />位比较</td>
<td align="center">bit</td>
</tr>
<tr>
<td align="center">RegexStringComparator<br />提供一个正则的比较器，仅支持 EQUAL 和非EQUAL</td>
<td align="center">regexstring</td>
</tr>
<tr>
<td align="center">SubstringComparator<br />判断提供的子串是否出现在table的value中，仅支持 EQUAL 和非EQUAL</td>
<td align="center">substring</td>
</tr>
</tbody></table>
<p>show_filters 命令能查看已有<strong>过滤器</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):052:0&gt; show_filters</span><br><span class="line">DependentColumnFilter</span><br><span class="line">KeyOnlyFilter</span><br><span class="line">ColumnCountGetFilter</span><br><span class="line">SingleColumnValueFilter</span><br><span class="line">PrefixFilter</span><br><span class="line">SingleColumnValueExcludeFilter</span><br><span class="line">FirstKeyOnlyFilter</span><br><span class="line">ColumnRangeFilter</span><br><span class="line">TimestampsFilter</span><br><span class="line">FamilyFilter</span><br><span class="line">QualifierFilter</span><br><span class="line">ColumnPrefixFilter</span><br><span class="line">RowFilter</span><br><span class="line">MultipleColumnPrefixFilter</span><br><span class="line">InclusiveStopFilter</span><br><span class="line">PageFilter</span><br><span class="line">ValueFilter</span><br><span class="line">ColumnPaginationFilter</span><br></pre></td></tr></table></figure>



<h6 id="RowFilter"><a href="#RowFilter" class="headerlink" title="RowFilter"></a>RowFilter</h6><p>基于rowkey来过滤数据。如果知道起始的 rowkey，建议是用 scan 的 STARTROW 和 ENDROW，速度快很多。因为 RowFilter是遍历所有 rowkey 的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;RowFilter(&#x3D;,&#39;substring:0000&#39;)&quot;&#125;</span><br><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;RowFilter(&lt;&#x3D;,&#39;binary:00009&#39;)&quot;&#125;</span><br><span class="line">scan &#39;test:userInfo&#39;, FILTER&#x3D;&gt;&quot;RowFilter(&#x3D;,&#39;substring:0000&#39;)&quot;</span><br><span class="line">scan &#39;test:userInfo&#39;, FILTER&#x3D;&gt;&quot;RowFilter(&lt;&#x3D;,&#39;binary:00009&#39;)&quot;</span><br></pre></td></tr></table></figure>



<h6 id="FamilyFilter"><a href="#FamilyFilter" class="headerlink" title="FamilyFilter"></a>FamilyFilter</h6><p>基于列簇来过滤数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,FILTER&#x3D;&gt;&quot;FamilyFilter(&#x3D;,&#39;substring:info&#39;)&quot;</span><br><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;FamilyFilter(&#x3D;,&#39;substring:info&#39;)&quot;&#125;</span><br></pre></td></tr></table></figure>



<h6 id="QualifierFilter"><a href="#QualifierFilter" class="headerlink" title="QualifierFilter"></a>QualifierFilter</h6><p>基于列来过滤数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;QualifierFilter(&#x3D;,&#39;substring:name&#39;)&quot;&#125;</span><br><span class="line">scan &#39;test:userInfo&#39;, FILTER&#x3D;&gt;&quot;QualifierFilter(&#x3D;,&#39;substring:name&#39;)&quot;</span><br></pre></td></tr></table></figure>



<h6 id="ValueFilter"><a href="#ValueFilter" class="headerlink" title="ValueFilter"></a>ValueFilter</h6><p>基于值来过滤数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;, FILTER&#x3D;&gt;&quot;ValueFilter(&#x3D;,&#39;substring:ll&#39;)&quot;</span><br><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;ValueFilter(&#x3D;,&#39;substring:ll&#39;)&quot;&#125;</span><br></pre></td></tr></table></figure>



<h6 id="DependentColumnFilter"><a href="#DependentColumnFilter" class="headerlink" title="DependentColumnFilter"></a>DependentColumnFilter</h6><p>过滤指定列簇里面，返回与参考列具有相同时间戳的数据。前两个参数指定 列簇和列，第三个参数布尔值，是否返回参考列的数据，true表示不返回，false表示返回，两个参数的就是默认false。第四五个参数就是比较运算符和比较器了，用来过滤 value。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;DependentColumnFilter(&#39;cf1&#39;,&#39;name&#39;)&quot;&#125;</span><br><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;DependentColumnFilter(&#39;cf1&#39;,&#39;name&#39;,true)&quot;&#125;</span><br><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;DependentColumnFilter(&#39;cf1&#39;,&#39;name&#39;,true,&#x3D;,&#39;substring:d&#39;)&quot;&#125;</span><br></pre></td></tr></table></figure>



<h6 id="SingleColumnValueFilter-和-SingleColumnValueExcludeFilter"><a href="#SingleColumnValueFilter-和-SingleColumnValueExcludeFilter" class="headerlink" title="SingleColumnValueFilter 和 SingleColumnValueExcludeFilter"></a>SingleColumnValueFilter 和 SingleColumnValueExcludeFilter</h6><p>用来查找并返回指定条件的列的数据，四个或六个参数，分别为 列簇、列、比较符、比较器、是否跳过无该列的行、是否查询历史版本，后面两个默认分别是 false、true 即 不跳过、不查询。：</p>
<ol>
<li>如果遍历到某行时，该行没有此 列簇:列 ，返回所有数据。如果选择跳过则不返回</li>
<li>如果遍历到某行时，该行有此 列簇:列 ，但是不符合条件，则该行所有数据都不返回</li>
<li>如果遍历到某行时，该行有此 列簇:列 ，并且也符合条件，则前者返回该行所有数据，后者返回除该列以外的所有数据</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">hbase(main):011:0&gt; scan &#39;test:userInfo&#39;</span><br><span class="line">ROW                                                                  COLUMN+CELL</span><br><span class="line"> 00001                                                               column&#x3D;baseInfo:name, timestamp&#x3D;1569403548008, value&#x3D;Michil</span><br><span class="line"> 00001                                                               column&#x3D;cf1:name, timestamp&#x3D;1569306706585, value&#x3D;Wade111</span><br><span class="line"> 00002                                                               column&#x3D;baseInfo:name, timestamp&#x3D;1569396888055, value&#x3D;dddd</span><br><span class="line"> 00003                                                               column&#x3D;cf1:name, timestamp&#x3D;1569396888055, value&#x3D;lalalla</span><br><span class="line"> 00004                                                               column&#x3D;cf1:name, timestamp&#x3D;1569396894851, value&#x3D;lalalla2222</span><br><span class="line"> 00005                                                               column&#x3D;cf1:name, timestamp&#x3D;1569396907028, value&#x3D;lalalla222333333</span><br><span class="line"> 00009                                                               column&#x3D;cf1:age, timestamp&#x3D;1569396888055, value&#x3D;dddd</span><br><span class="line"> 00009                                                               column&#x3D;cf1:name, timestamp&#x3D;1569396888055, value&#x3D;dddd</span><br><span class="line"> 00010                                                               column&#x3D;cf1:age, timestamp&#x3D;1569396888055, value&#x3D;1111</span><br><span class="line"> 00011                                                               column&#x3D;baseInfo:age, timestamp&#x3D;1569396888055, value&#x3D;1111</span><br><span class="line"> 00012                                                               column&#x3D;baseInfo:name, timestamp&#x3D;1569461934129, value&#x3D;ddd</span><br><span class="line"> 00012                                                               column&#x3D;cf1:name, timestamp&#x3D;1569462029439, value&#x3D;ddd</span><br><span class="line">9 row(s) in 0.0270 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):012:0&gt;  scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;SingleColumnValueFilter(&#39;cf1&#39;,&#39;name&#39;,&#x3D;,&#39;substring:d&#39;)&quot;&#125;</span><br><span class="line">ROW                                                                  COLUMN+CELL</span><br><span class="line"> 00001                                                               column&#x3D;baseInfo:name, timestamp&#x3D;1569403548008, value&#x3D;Michil</span><br><span class="line"> 00001                                                               column&#x3D;cf1:name, timestamp&#x3D;1569306706585, value&#x3D;Wade111</span><br><span class="line"> 00002                                                               column&#x3D;baseInfo:name, timestamp&#x3D;1569396888055, value&#x3D;dddd</span><br><span class="line"> 00009                                                               column&#x3D;cf1:age, timestamp&#x3D;1569396888055, value&#x3D;dddd</span><br><span class="line"> 00009                                                               column&#x3D;cf1:name, timestamp&#x3D;1569396888055, value&#x3D;dddd</span><br><span class="line"> 00010                                                               column&#x3D;cf1:age, timestamp&#x3D;1569396888055, value&#x3D;1111</span><br><span class="line"> 00011                                                               column&#x3D;baseInfo:age, timestamp&#x3D;1569396888055, value&#x3D;1111</span><br><span class="line"> 00012                                                               column&#x3D;baseInfo:name, timestamp&#x3D;1569461934129, value&#x3D;ddd</span><br><span class="line"> 00012                                                               column&#x3D;cf1:name, timestamp&#x3D;1569462029439, value&#x3D;ddd</span><br><span class="line">6 row(s) in 0.0300 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):013:0&gt;  scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;SingleColumnValueFilter(&#39;cf1&#39;,&#39;name&#39;,&#x3D;,&#39;substring:d&#39;,true,false)&quot;&#125;</span><br><span class="line">ROW                                                                  COLUMN+CELL</span><br><span class="line"> 00001                                                               column&#x3D;baseInfo:name, timestamp&#x3D;1569403548008, value&#x3D;Michil</span><br><span class="line"> 00001                                                               column&#x3D;cf1:name, timestamp&#x3D;1569306706585, value&#x3D;Wade111</span><br><span class="line"> 00009                                                               column&#x3D;cf1:age, timestamp&#x3D;1569396888055, value&#x3D;dddd</span><br><span class="line"> 00009                                                               column&#x3D;cf1:name, timestamp&#x3D;1569396888055, value&#x3D;dddd</span><br><span class="line"> 00012                                                               column&#x3D;baseInfo:name, timestamp&#x3D;1569461934129, value&#x3D;ddd</span><br><span class="line"> 00012                                                               column&#x3D;cf1:name, timestamp&#x3D;1569462029439, value&#x3D;ddd</span><br><span class="line">3 row(s) in 0.0100 seconds</span><br><span class="line"></span><br><span class="line">hbase(main):014:0&gt;  scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;SingleColumnValueExcludeFilter(&#39;cf1&#39;,&#39;name&#39;,&#x3D;,&#39;substring:d&#39;)&quot;&#125;</span><br><span class="line">ROW                                                                  COLUMN+CELL</span><br><span class="line"> 00001                                                               column&#x3D;baseInfo:name, timestamp&#x3D;1569403548008, value&#x3D;Michil</span><br><span class="line"> 00002                                                               column&#x3D;baseInfo:name, timestamp&#x3D;1569396888055, value&#x3D;dddd</span><br><span class="line"> 00009                                                               column&#x3D;cf1:age, timestamp&#x3D;1569396888055, value&#x3D;dddd</span><br><span class="line"> 00010                                                               column&#x3D;cf1:age, timestamp&#x3D;1569396888055, value&#x3D;1111</span><br><span class="line"> 00011                                                               column&#x3D;baseInfo:age, timestamp&#x3D;1569396888055, value&#x3D;1111</span><br><span class="line"> 00012                                                               column&#x3D;baseInfo:name, timestamp&#x3D;1569461934129, value&#x3D;ddd</span><br><span class="line">6 row(s) in 0.0080 seconds</span><br></pre></td></tr></table></figure>



<h6 id="PrefixFilter"><a href="#PrefixFilter" class="headerlink" title="PrefixFilter"></a>PrefixFilter</h6><p>针对 rowkey 前缀来进行匹配的过滤器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;PrefixFilter(&#39;0001&#39;)&quot;&#125;     # rowkey 前缀为 0001的所有行</span><br><span class="line">scan &#39;test:userInfo&#39;,FILTER&#x3D;&gt;&quot;PrefixFilter(&#39;0000&#39;)&quot;       # rowkey 前缀为 0000的所有行</span><br></pre></td></tr></table></figure>



<h6 id="PageFilter"><a href="#PageFilter" class="headerlink" title="PageFilter"></a>PageFilter</h6><p>取回N条数据。在shell中用法就是这样，API不知道能不能实现分页</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,FILTER&#x3D;&gt;&quot;PageFilter(8)&quot;     # 取回 8 条数据</span><br></pre></td></tr></table></figure>



<h6 id="KeyOnlyFilter"><a href="#KeyOnlyFilter" class="headerlink" title="KeyOnlyFilter"></a>KeyOnlyFilter</h6><p>一个参数 lenAsVal，默认为 false。false 时value返回为 空， true 时返回的是value的val值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,FILTER&#x3D;&gt;&quot;KeyOnlyFilter(true)&quot;</span><br></pre></td></tr></table></figure>



<h6 id="FirstKeyOnlyFilter"><a href="#FirstKeyOnlyFilter" class="headerlink" title="FirstKeyOnlyFilter"></a>FirstKeyOnlyFilter</h6><p>返回每行第一个KV对，即每行的第一个 rowkey:列簇:列:value 对。对于count 和 sum 场景，可以带来性能提升。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,FILTER&#x3D;&gt;&quot;FirstKeyOnlyFilter()&quot;</span><br></pre></td></tr></table></figure>



<h6 id="InclusiveStopFilter"><a href="#InclusiveStopFilter" class="headerlink" title="InclusiveStopFilter"></a>InclusiveStopFilter</h6><p>设置 stoprow，返回stoprow之前的数据（包括 stoprow 行）。可以配合 startrow使用，相当于stoprow的闭区间用法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;InclusiveStopFilter(&#39;00009&#39;)&quot;&#125;   # 起始行到 00009 行</span><br><span class="line">scan &#39;test:userInfo&#39;,&#123;STARTROW&#x3D;&gt;&#39;00002&#39;,FILTER&#x3D;&gt;&quot;InclusiveStopFilter(&#39;00009&#39;)&quot;&#125; # 00002 到 00009 行</span><br></pre></td></tr></table></figure>



<h6 id="TimestampsFilter"><a href="#TimestampsFilter" class="headerlink" title="TimestampsFilter"></a>TimestampsFilter</h6><p>基于 时间戳来过滤。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;TimestampsFilter(1569403548008,1569396894851)&quot;&#125;</span><br></pre></td></tr></table></figure>



<h6 id="ColumnCountGetFilter"><a href="#ColumnCountGetFilter" class="headerlink" title="ColumnCountGetFilter"></a>ColumnCountGetFilter</h6><p>限制每行最多返回多少列。 更适用于 get，不是很适合 scan，但能用。</p>
<p>get 时，每行最多返回多少列。scan 时的用法很乱，没他看懂…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get &#39;test:userInfo&#39; , &#39;00003&#39; ,&#123;FILTER&#x3D;&gt;&quot;ColumnCountGetFilter(1)&quot;&#125;</span><br></pre></td></tr></table></figure>



<h6 id="ColumnPaginationFilter"><a href="#ColumnPaginationFilter" class="headerlink" title="ColumnPaginationFilter"></a>ColumnPaginationFilter</h6><p>限制返回列数，第一个参数为限制的列数，第二个参数为偏移量，即从第几列开始返回（0开始，）。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;ColumnPaginationFilter(1,1)&quot;&#125;  # 从第二列开始返回，返回一列</span><br></pre></td></tr></table></figure>



<h6 id="ColumnPrefixFilter"><a href="#ColumnPrefixFilter" class="headerlink" title="ColumnPrefixFilter"></a>ColumnPrefixFilter</h6><p>列前缀过滤器。过滤出列前缀为 XX 的所有数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;ColumnPrefixFilter(&#39;ag&#39;)&quot;&#125;</span><br></pre></td></tr></table></figure>



<h6 id="MultipleColumnPrefixFilter"><a href="#MultipleColumnPrefixFilter" class="headerlink" title="MultipleColumnPrefixFilter"></a>MultipleColumnPrefixFilter</h6><p>ColumnPrefixFilter 加强版，支持一种和多种前缀</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;MultipleColumnPrefixFilter(&#39;ag&#39;,&#39;na&#39;)&quot;&#125;</span><br></pre></td></tr></table></figure>



<h6 id="ColumnRangeFilter"><a href="#ColumnRangeFilter" class="headerlink" title="ColumnRangeFilter"></a>ColumnRangeFilter</h6><p>列范围过滤器。在指定的范围内查找所有列数据。四个参数：最小列、是否包含最小列、最大列、是否包含最大列。大小是按字典排序的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scan &#39;test:userInfo&#39;,&#123;FILTER&#x3D;&gt;&quot;ColumnRangeFilter(&#39;ag&#39;,true,&#39;name&#39;,true)&quot;&#125;</span><br></pre></td></tr></table></figure>



<h6 id="RandomRowFilter-—"><a href="#RandomRowFilter-—" class="headerlink" title="RandomRowFilter —"></a>RandomRowFilter —</h6><p>shell不支持。</p>
<p>参数小于0，不返回数据。参数大于1，返回所有数据。参数位于 0-1，随机返回数据。</p>
<h6 id="SkipFilter-—"><a href="#SkipFilter-—" class="headerlink" title="SkipFilter —-"></a>SkipFilter —-</h6><p>shell不支持</p>
<p>一行中，只要存在一列不满足条件，整行都会被过滤</p>
<h6 id="WhileMatchFilters-—"><a href="#WhileMatchFilters-—" class="headerlink" title="WhileMatchFilters —-"></a>WhileMatchFilters —-</h6><p>相当于 while。直到 不 match ，然后 break 返回。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Apache/" rel="tag"># Apache</a>
          
            <a href="/tags/Hbase/" rel="tag"># Hbase</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/04/11/Apache-Hbase/%E8%A1%A8%E8%AE%BE%E8%AE%A1%E5%92%8C%E9%AB%98%E7%BA%A7%E5%B1%9E%E6%80%A7/" rel="next" title="Hbase表设计和高级属性">
                <i class="fa fa-chevron-left"></i> Hbase表设计和高级属性
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/05/01/Apache-Hbase/Hbase%EF%BC%8C%E4%BB%8E%E4%B8%8D%E7%9D%A1%E8%A7%89%E8%AF%B4%E8%B5%B7%E2%80%A6/" rel="prev" title="Hbase基础API">
                Hbase基础API <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/blog.jpg"
               alt="Roman" />
          <p class="site-author-name" itemprop="name">Roman</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">54</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#一、基础理论"><span class="nav-number">1.</span> <span class="nav-text">一、基础理论</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二、组件功能："><span class="nav-number">2.</span> <span class="nav-text">二、组件功能：</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Hbase数据模型："><span class="nav-number">2.0.0.1.</span> <span class="nav-text">Hbase数据模型：</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三、-HBase-shell-基本操作"><span class="nav-number">3.</span> <span class="nav-text">三、 HBase shell 基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#命名空间相关"><span class="nav-number">3.1.</span> <span class="nav-text">命名空间相关</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#创建命名空间"><span class="nav-number">3.1.0.1.</span> <span class="nav-text">创建命名空间</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#删除命名空间"><span class="nav-number">3.1.0.2.</span> <span class="nav-text">删除命名空间</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#表相关"><span class="nav-number">3.2.</span> <span class="nav-text">表相关</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#创建表"><span class="nav-number">3.2.0.1.</span> <span class="nav-text">创建表</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#列出表"><span class="nav-number">3.2.0.2.</span> <span class="nav-text">列出表</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#查看表"><span class="nav-number">3.2.0.3.</span> <span class="nav-text">查看表</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#删除表"><span class="nav-number">3.2.0.4.</span> <span class="nav-text">删除表</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#启停表"><span class="nav-number">3.2.0.5.</span> <span class="nav-text">启停表</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#修改表"><span class="nav-number">3.2.0.6.</span> <span class="nav-text">修改表</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查询相关"><span class="nav-number">3.3.</span> <span class="nav-text">查询相关</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#scan"><span class="nav-number">3.3.0.1.</span> <span class="nav-text">scan</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#get"><span class="nav-number">3.3.0.2.</span> <span class="nav-text">get</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#count"><span class="nav-number">3.3.0.3.</span> <span class="nav-text">count</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除相关"><span class="nav-number">3.4.</span> <span class="nav-text">删除相关</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#delete"><span class="nav-number">3.4.0.1.</span> <span class="nav-text">delete</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#deleteall"><span class="nav-number">3.4.0.2.</span> <span class="nav-text">deleteall</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#过滤器相关"><span class="nav-number">3.5.</span> <span class="nav-text">过滤器相关</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#过滤器基础"><span class="nav-number">3.5.0.1.</span> <span class="nav-text">过滤器基础</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#RowFilter"><span class="nav-number">3.5.0.2.</span> <span class="nav-text">RowFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#FamilyFilter"><span class="nav-number">3.5.0.3.</span> <span class="nav-text">FamilyFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#QualifierFilter"><span class="nav-number">3.5.0.4.</span> <span class="nav-text">QualifierFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ValueFilter"><span class="nav-number">3.5.0.5.</span> <span class="nav-text">ValueFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#DependentColumnFilter"><span class="nav-number">3.5.0.6.</span> <span class="nav-text">DependentColumnFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#SingleColumnValueFilter-和-SingleColumnValueExcludeFilter"><span class="nav-number">3.5.0.7.</span> <span class="nav-text">SingleColumnValueFilter 和 SingleColumnValueExcludeFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#PrefixFilter"><span class="nav-number">3.5.0.8.</span> <span class="nav-text">PrefixFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#PageFilter"><span class="nav-number">3.5.0.9.</span> <span class="nav-text">PageFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#KeyOnlyFilter"><span class="nav-number">3.5.0.10.</span> <span class="nav-text">KeyOnlyFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#FirstKeyOnlyFilter"><span class="nav-number">3.5.0.11.</span> <span class="nav-text">FirstKeyOnlyFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#InclusiveStopFilter"><span class="nav-number">3.5.0.12.</span> <span class="nav-text">InclusiveStopFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#TimestampsFilter"><span class="nav-number">3.5.0.13.</span> <span class="nav-text">TimestampsFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ColumnCountGetFilter"><span class="nav-number">3.5.0.14.</span> <span class="nav-text">ColumnCountGetFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ColumnPaginationFilter"><span class="nav-number">3.5.0.15.</span> <span class="nav-text">ColumnPaginationFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ColumnPrefixFilter"><span class="nav-number">3.5.0.16.</span> <span class="nav-text">ColumnPrefixFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#MultipleColumnPrefixFilter"><span class="nav-number">3.5.0.17.</span> <span class="nav-text">MultipleColumnPrefixFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#ColumnRangeFilter"><span class="nav-number">3.5.0.18.</span> <span class="nav-text">ColumnRangeFilter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#RandomRowFilter-—"><span class="nav-number">3.5.0.19.</span> <span class="nav-text">RandomRowFilter —</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#SkipFilter-—"><span class="nav-number">3.5.0.20.</span> <span class="nav-text">SkipFilter —-</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#WhileMatchFilters-—"><span class="nav-number">3.5.0.21.</span> <span class="nav-text">WhileMatchFilters —-</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Roman</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="noopener">
    NexT.Gemini
  </a>
</div>


        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      访客数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人
    </span>
  

  
    <span class="site-pv">
      访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>


        
      </div>
    </footer>

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

</body>
</html>
